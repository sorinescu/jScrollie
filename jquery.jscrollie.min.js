(function(b){function d(a){var f=b('<div class="jScrollieClear" style="clear:both;"></div>').appendTo(a);a.wrapInner('<div class="jScrollieMetaContainer"><div class="jScrollie"><div class="jScrollieContent">');b('<div class="jScrollieContainer"><div class="jScrollieTrack"><div class="jScrollieDrag"><div class="jScrollieDragTop"></div><div class="jScrollieDragBottom"></div></div></div></div>').prependTo(a);a.wrapInner('<div class="jScrollieAll">');this.scrollData={root:a,jScroll:b(".jScrollieContainer",
a),track:b(".jScrollieTrack",a),drag:b(".jScrollieDrag",a),dragTop:b(".jScrollieDragTop",a),dragBottom:b(".jScrollieDragBottom",a),content:b(".jScrollieContent",a),clearer:f,scroller:b(".jScrollie",a)};this.update();b.fn.mutate&&this.scrollData.content.mutate("scrollHeight",function(){a.jScrollieUpdate()})}b.fn.jScrollie=function(){this.each(function(){b(this).data("jScrollie",new d(b(this)))});return this};b.fn.jScrollieUpdate=function(){this.each(function(){var a=b(this).data("jScrollie");a&&a.update()});
return this};d.prototype={nativeSize:void 0,scrollbarSize:function(){if(void 0===this.nativeSize){var a=b('<div class="jScrollie" style="width:50px;height:50px;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div></div>');b("body").append(a);var f=b(a).innerWidth(),c=b("div",a).innerWidth();b(a).remove();this.nativeSize=f-c}return this.nativeSize},checkRefresh:function(){console.log("checking refresh");this.update()},update:function(){var a=this.scrollData,b=a.root,
c=a.clearer.position().top-a.content.position().top;a.height=a.scroller.height();a.contentHeight=c;a.offset=a.scroller.offset();b.unbind();var e=this.scrollData.scroller.height()/c,d=-this.scrollbarSize();if(1>e){a.scroller.css("margin-right",d+"px");a.content.addClass("Scrollbar");a.jScroll.show();a.jScroll.height(a.scroller.height());a.scroller.offset();var h=Math.max(Math.round(a.scroller.height()*e),a.dragTop.height()+a.dragBottom.height());a.drag.height(h);var g=this;a.scroller.scroll(function(){g.scrollData.drag.css("top",
Math.min(Math.round(g.scrollData.scroller.scrollTop()*e),g.scrollData.scroller.height()-h)+"px")});a.scroller.scroll();var j=function(){b.unbind("mousemove.jScrollie")};a.drag.mousedown(function(c){j();var d=c.pageY-a.drag.offset().top;b.bind("mousemove.jScrollie",function(b){a.scroller.scrollTop((b.pageY-a.scroller.offset().top-d)/e);return!1}).mouseup(j);return!1});a.track.mousedown(function(b){a.scroller.scrollTop((b.pageY-20)/a.scroller.height()*c)})}else a.scroller.css("margin-right",0),a.jScroll.hide(),
a.content.removeClass("Scrollbar")}}})(jQuery);
